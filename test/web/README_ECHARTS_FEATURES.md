# ECharts PID监控系统功能说明

## 🎯 概述

已将原有的Chart.js图表库升级为ECharts，提供更强大的数据可视化和交互功能。

## 🚀 新增功能

### 1. 增强的数据容量
- **数据窗口**: 从100点增加到1000点（可调整到5000点）
- **更大缓存**: 支持更长时间的数据记录
- **内存优化**: 自动清理超出窗口的历史数据

### 2. 灵活的X轴筛选
- **时间范围选择**: 10秒/30秒/60秒/全部数据
- **鼠标滚轮缩放**: 在图表上滚动鼠标进行缩放
- **拖拽平移**: 按住鼠标左键拖拽查看不同时间段
- **自动跟踪**: 默认显示最新数据，自动滚动

### 3. 丰富的交互工具
- **工具栏功能**:
  - 🔍 数据缩放工具
  - 🔄 还原视图
  - 💾 保存图片
- **图例控制**: 点击图例显示/隐藏对应曲线
- **十字准线**: 鼠标悬停显示精确数值
- **数据提示**: 智能提示框显示多条曲线数据

### 4. 可配置参数
- **数据窗口大小**: 500/1000/2000/5000点可选
- **显示时间范围**: 灵活调整显示的时间窗口
- **图例开关**: 一键显示/隐藏图例
- **缩放重置**: 快速恢复到全视图

## 🎮 操作指南

### 基本操作
1. **开始监控**: 点击"开始监控"按钮
2. **调整PID参数**: 修改参数值并点击"发送参数"
3. **观察曲线**: 实时查看四路PID输出曲线

### 高级操作
1. **缩放查看**:
   - 鼠标滚轮: 在图表上滚动进行缩放
   - 工具栏: 使用缩放工具精确选择区域
   
2. **时间筛选**:
   - 下拉菜单: 选择显示时间范围
   - 拖拽: 手动平移查看历史数据
   
3. **数据管理**:
   - 调整数据窗口大小避免内存占用过大
   - 清除数据重新开始记录
   - 保存图片用于分析报告

### 曲线说明
- **🔴 vel_kp输出**: 速度PID控制器输出
- **🔵 balance_kp输出**: 平衡PID控制器输出  
- **🟡 balance_kd输出**: 平衡微分控制器输出
- **🟢 robot_kp输出**: 机器人整体PID输出

## 📊 性能优化

### 数据处理
- **滑动窗口**: 自动维护固定大小的数据缓存
- **实时更新**: 20Hz采样率，流畅显示
- **内存控制**: 防止长时间运行导致的内存泄漏

### 渲染优化
- **禁用动画**: 提高实时数据更新性能
- **按需更新**: 只更新变化的数据系列
- **响应式设计**: 自动适应不同屏幕尺寸

## 🔧 技术细节

### 数据格式
```javascript
// ECharts数据格式 [时间, 数值]
chartData = {
    timestamps: [0, 0.05, 0.1, ...],
    vel_output: [[0, 0.1], [0.05, 0.2], ...],
    balance_output: [[0, 0.3], [0.05, 0.4], ...],
    // ...
}
```

### 配置选项
```javascript
// 主要配置参数
var dataWindow = 1000;        // 数据窗口大小
var displayTimeRange = 30;    // 显示时间范围(秒)
var legendVisible = true;     // 图例显示状态
```

## 🚀 使用示例

### 启动系统
```bash
# 启动服务器
python test_server_enhanced.py

# 在浏览器中打开
http://localhost:8080
```

### 测试功能
```bash
# 运行功能测试
python test_echarts.py

# 生成示例数据
python simulate_pid_data.py sample 100
```

## 📈 应用场景

### 实时调试
- PID参数调优过程可视化
- 实时观察控制效果
- 快速定位问题时间点

### 数据分析
- 长时间数据趋势分析
- 不同参数设置对比
- 系统稳定性评估

### 演示展示
- 保存关键时刻的图表截图
- 缩放到感兴趣的时间段
- 清晰展示控制算法效果

## 🔮 未来扩展

### 计划功能
- [ ] 数据导出功能 (CSV/JSON)
- [ ] 多图表对比视图
- [ ] 频域分析图表
- [ ] 自定义Y轴范围
- [ ] 数据标注功能

### 性能提升
- [ ] WebGL渲染支持
- [ ] 数据压缩传输
- [ ] 离线数据缓存
- [ ] 多线程数据处理

---

## 📞 技术支持

如有问题或建议，请参考：
- `test_server_enhanced.py` - 服务器实现
- `data/robot_web_control.html` - 前端实现
- `simulate_pid_data.py` - 数据模拟器 